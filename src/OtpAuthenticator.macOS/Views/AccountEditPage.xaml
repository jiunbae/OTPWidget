<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:OtpAuthenticator.macOS.ViewModels"
             x:Class="OtpAuthenticator.macOS.Views.AccountEditPage"
             x:DataType="viewmodels:AccountEditViewModel"
             Title="{Binding Title}">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Save" Command="{Binding SaveCommand}" />
        <ToolbarItem Text="Cancel" Command="{Binding CancelCommand}" />
    </ContentPage.ToolbarItems>

    <ScrollView Padding="20">
        <StackLayout Spacing="15">

            <!-- Error Message -->
            <Label Text="{Binding ErrorMessage}"
                   TextColor="Red"
                   IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}"
                   Margin="0,0,0,10" />

            <!-- QR Code Button -->
            <Button Text="Scan QR Code"
                    Command="{Binding ScanQrCodeCommand}"
                    IsVisible="{Binding IsEditing, Converter={StaticResource InvertedBoolConverter}}"
                    Margin="0,0,0,20" />

            <!-- Manual Entry -->
            <Label Text="Or enter manually:" FontSize="16" FontAttributes="Bold" />

            <!-- Issuer -->
            <StackLayout>
                <Label Text="Issuer (Service Name)" />
                <Entry Text="{Binding Issuer}"
                       Placeholder="e.g., Google, GitHub, Microsoft" />
            </StackLayout>

            <!-- Account Name -->
            <StackLayout>
                <Label Text="Account Name" />
                <Entry Text="{Binding AccountName}"
                       Placeholder="e.g., user@example.com" />
            </StackLayout>

            <!-- Secret Key -->
            <StackLayout>
                <Label Text="Secret Key" />
                <Entry Text="{Binding SecretKey}"
                       Placeholder="Base32 encoded secret"
                       IsPassword="True" />
            </StackLayout>

            <!-- Advanced Options -->
            <Label Text="Advanced Options"
                   FontSize="16"
                   FontAttributes="Bold"
                   Margin="0,20,0,10" />

            <!-- OTP Type -->
            <StackLayout>
                <Label Text="Type" />
                <Picker ItemsSource="{Binding OtpTypes}"
                        SelectedItem="{Binding OtpType}" />
            </StackLayout>

            <!-- Algorithm -->
            <StackLayout>
                <Label Text="Algorithm" />
                <Picker ItemsSource="{Binding Algorithms}"
                        SelectedItem="{Binding Algorithm}" />
            </StackLayout>

            <!-- Digits -->
            <StackLayout>
                <Label Text="Digits" />
                <Picker ItemsSource="{Binding DigitOptions}"
                        SelectedItem="{Binding Digits}" />
            </StackLayout>

            <!-- Period -->
            <StackLayout>
                <Label Text="Period (seconds)" />
                <Picker ItemsSource="{Binding PeriodOptions}"
                        SelectedItem="{Binding Period}" />
            </StackLayout>

            <!-- Buttons -->
            <Grid ColumnDefinitions="*,*" Margin="0,30,0,0">
                <Button Grid.Column="0"
                        Text="Cancel"
                        Command="{Binding CancelCommand}"
                        BackgroundColor="{StaticResource Gray200}" />
                <Button Grid.Column="1"
                        Text="Save"
                        Command="{Binding SaveCommand}" />
            </Grid>

        </StackLayout>
    </ScrollView>

</ContentPage>
