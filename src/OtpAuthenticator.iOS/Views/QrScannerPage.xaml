<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:zxing="clr-namespace:ZXing.Net.Maui.Controls;assembly=ZXing.Net.MAUI.Controls"
             xmlns:viewmodels="clr-namespace:OtpAuthenticator.iOS.ViewModels"
             x:Class="OtpAuthenticator.iOS.Views.QrScannerPage"
             x:DataType="viewmodels:QrScannerViewModel"
             Title="Scan QR Code">

    <Grid>
        <zxing:CameraBarcodeReaderView
            x:Name="barcodeReader"
            BarcodesDetected="OnBarcodesDetected"
            Options="{Binding ScannerOptions}"
            IsDetecting="{Binding IsScanning}" />

        <!-- Overlay -->
        <Grid BackgroundColor="#80000000" InputTransparent="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="250" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="250" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Transparent scanning area -->
            <BoxView Grid.Row="1" Grid.Column="1"
                     BackgroundColor="Transparent"
                     InputTransparent="True" />

            <!-- Border around scanning area -->
            <Border Grid.Row="1" Grid.Column="1"
                    Stroke="{StaticResource Primary}"
                    StrokeThickness="3"
                    StrokeShape="RoundRectangle 10"
                    BackgroundColor="Transparent"
                    InputTransparent="True" />
        </Grid>

        <!-- Instructions -->
        <Label Text="Point your camera at a QR code"
               TextColor="White"
               FontSize="16"
               HorizontalOptions="Center"
               VerticalOptions="End"
               Margin="0,0,0,100" />

        <!-- Cancel Button -->
        <Button Text="Cancel"
                Command="{Binding CancelCommand}"
                BackgroundColor="{StaticResource Gray600}"
                HorizontalOptions="Center"
                VerticalOptions="End"
                Margin="0,0,0,40" />
    </Grid>

</ContentPage>
